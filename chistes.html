<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabla de Precios</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        select {
            width: 100%;
        }
    </style>
</head>
<body>

    <h2>Orden de</h2>

    <table id="tablaPrecios">
        <thead>
            <tr>
                <th>Descripción</th>
                <th>Precio</th>
                <th>Cantidad</th>
                <th>IGV (%)</th>
                <th>Detracción (%)</th>
                <th>Precio Total</th>
                <th>Proveedor</th>
                <th>Banco</th>
                <th>Número Bancario</th>
                <th>Cuotas</th>
                <th>Tipo de Pago</th>
            </tr>
        </thead>
        <tbody>
            <!-- No hay filas predefinidas -->
        </tbody>
    </table>

    <button onclick="agregarFila()">Agregar Fila</button>

    <script>
        // Función para calcular el precio total
        function calcularPrecioTotal() {
            var filas = document.querySelectorAll("#tablaPrecios tbody tr");

            filas.forEach(function (fila) {
                var precio = parseFloat(fila.cells[1].innerText);
                var cantidad = parseFloat(fila.cells[2].innerText);
                var precioTotal = precio * cantidad;

                // Obtener valores de IGV, detracción, cuotas y tipo de pago
                var igv = parseFloat(fila.cells[3].innerText) || 0;
                var detraccion = parseFloat(fila.cells[4].innerText) || 0;
                var cuotas = parseFloat(fila.cells[9].innerText) || 0;
                var tipoPago = fila.cells[10].innerText;

                // Calcular precio total con IGV y detracción
                precioTotal = precioTotal + (precioTotal * igv / 100);
                precioTotal = precioTotal - (precioTotal * detraccion / 100);

                fila.cells[5].innerText = precioTotal.toFixed(2) + ' ' + tipoPago;
            });
        }

        // Función para actualizar el banco y número bancario al seleccionar un proveedor
        function actualizarInfoProveedor(proveedor) {
            var proveedoresInfo = {
                "Pepsi": { banco: "Banco A", numero: "123456789" },
                "CocaCola": { banco: "Banco B", numero: "987654321" },
                // Puedes agregar más proveedores con su información asociada
            };

            var fila = proveedor.closest("tr");
            fila.cells[7].innerText = proveedoresInfo[proveedor.value]?.banco || "";
            fila.cells[8].innerText = proveedoresInfo[proveedor.value]?.numero || "";
        }

        // Agregar evento de cambio al seleccionar un proveedor
        var proveedores = document.querySelectorAll(".proveedor");
        proveedores.forEach(function (proveedor) {
            proveedor.addEventListener("change", function () {
                actualizarInfoProveedor(proveedor);
            });
        });

        // Agregar evento de input a las celdas editables
        var celdasEditables = document.querySelectorAll("#tablaPrecios [contenteditable='true']");
        celdasEditables.forEach(function (celda) {
            celda.addEventListener("input", calcularPrecioTotal);
        });

        var celdaPrecioTotal = document.querySelectorAll("#tablaPrecios tbody td:nth-child(6)");
        celdaPrecioTotal.forEach(function (celda) {
            celda.addEventListener("input", calcularPrecioTotal);
        });

        // Función para agregar nueva fila
        function agregarFila() {
            var tbody = document.querySelector("#tablaPrecios tbody");

            var newRow = tbody.insertRow();
            newRow.innerHTML = `
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td></td>
                <td>
                    <select class="proveedor" onchange="actualizarInfoProveedor(this)">
                        <option value=""></option>
                        <option value="Pepsi">Pepsi</option>
                        <option value="CocaCola">CocaCola</option>
                        <!-- Puedes agregar más proveedores aquí -->
                    </select>
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            `;
        }

    </script>

</body>
</html>
